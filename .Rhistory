#| warning: false
#| message: false
#vtable(caschool)
m1<-lm(testscr~str,data = caschool)
pkg_list <- c(
"tidyverse", "gt", "gtExtras", "reactable", "ggiraph", "here", "quarto",
"rmarkdown", "gtsummary", "palmerpenguins", "fs", "skimr"
)
install.packages(pkg_list)
#| warning:
library(haven)
library(kableExtra)
library(tidyverse)
caschool <- read_dta("caschool.dta")
library(modelsummary)
library(rstatix)
caschool<-caschool %>% mutate(elq1=ifelse(el_pct<=1.9,1,0))
caschool<-caschool %>% mutate(elq2=ifelse(el_pct>=1.9 & el_pct<8.8,1,0))
caschool<-caschool %>% mutate(elq3=ifelse(el_pct>=8.8 & el_pct<23,1,0))
caschool<-caschool %>% mutate(elq4=ifelse(el_pct>=23,1,0))
caschool<-caschool %>%   mutate(str_20 = ifelse(str<20, 1,0))
overall<-caschool %>% t_test(testscr~str_20,var.equal=T)
el_1.9<-caschool %>% filter(elq1==1) %>% t_test(testscr~str_20,var.equal=T)
el_8.8<-caschool %>% filter(elq2==1) %>% t_test(testscr~str_20,var.equal=T)
el_23<-caschool %>% filter(elq3==1) %>% t_test(testscr~str_20,var.equal=T)
el_gr23<-caschool %>% filter(elq4==1) %>% t_test(testscr~str_20,var.equal=T)
table_6.1<-bind_rows(overall,el_1.9,el_8.8,el_23,el_gr23)
df_tbl<- as_tibble(table_6.1)
df_tbl<-df_tbl %>% select(-".y.")
df_tbl$statistic<-round(df_tbl$statistic,2)
df_tbl$p<-round(df_tbl$p,3)
df_tbl
models<-list(mod1<-lm(testscr~str,data = caschool),
mod2<-lm(testscr~str+el_pct,data = caschool))
mod1<-lm(testscr~str,data = caschool)
mod2<-lm(testscr~str+el_pct,data = caschool)
modelsummary(
models,
fmt = 2,
estimate  = c(
"{estimate} ({std.error}){stars}"),
statistic = NULL)
y_x2<-lm(testscr~el_pct, data=caschool)
x1_x2<-lm(str~el_pct,data=caschool)
resid1<-y_x2$residuals
resid2<-x1_x2$residuals
resid_mod<-lm(resid1~resid2)
models<-list(mod1, mod2,resid_mod)
modelsummary(models)
modelsummary(lm(testscr~str+str,data=caschool))
library(car)
# estimate the multiple regression model
model <- lm(testscr ~ str + el_pct + meal_pct, data = caschool)
# execute the function on the model object and provide both linear restrictions
# to be tested as strings
linearHypothesis(model, c("str=0", "el_pct=0"))
linearHypothesis(model,c('el_pct+meal_pct=1'))
#| warning: false
library(corrr)
caschool|> select(testscr, str, el_pct, meal_pct, calw_pct)|>
correlate()|>
autoplot()+geom_text(aes(label=round(r,digits = 2)),size=2)
p1<- ggplot(caschool)+aes(x=el_pct,y=testscr)+geom_point()+
labs(x="percent",y="Test Score")
p2<- ggplot(caschool)+aes(x=meal_pct,y=testscr)+geom_point()+
labs(x="percent",y="Test Score")
p3<- ggplot(caschool)+aes(x=calw_pct,y=testscr)+geom_point()+
labs(x="percent",y="Test Score")
library(gridExtra)
#grid.arrange(p1,p2,p3, nrow=3)
p1
p2
p3
#| warning: false
#| message: false
#vtable(caschool)
m1<-lm(testscr~str,data = caschool)
m2<-lm(testscr~str+el_pct,data = caschool)
m3<-lm(testscr~str+el_pct+meal_pct,data = caschool)
m4<-lm(testscr~str+el_pct+calw_pct,data = caschool)
m5<-lm(testscr~str+el_pct+el_pct+calw_pct,data = caschool)
library(fixest)
library(modelsummary)
models<-list(m1,m2,m3,m4,m5)
library(huxtable)
#etable(m1,m2,m3,m4)
modelsummary(models,estimate = "{estimate}{stars}", output="huxtable")
#modelsummary(models, fmt=4)
#modelsummary(models,
#            statistic = "{std.error} ({p.value})")
#modelsummary(models,
#            estimate = "{estimate}{stars}",
#           gof_omit = ".*")
m5<-lm(testscr~str+el_pct+el_pct+calw_pct,data = caschool)
#| warning: false
#| message: false
#vtable(caschool)
m1<-lm(testscr~str,data = caschool)
m2<-lm(testscr~str+el_pct,data = caschool)
m3<-lm(testscr~str+el_pct+meal_pct,data = caschool)
m4<-lm(testscr~str+el_pct+calw_pct,data = caschool)
m5<-lm(testscr~str+el_pct+el_pct+calw_pct,data = caschool)
library(modelsummary)
models<-list(m1,m2,m3,m4,m5)
library(huxtable)
#etable(m1,m2,m3,m4)
modelsummary(models,estimate = "{estimate}{stars}", output="huxtable")
m5<-lm(testscr~str+el_pct+meal_pct+calw_pct,data = caschool)
#etable(m1,m2,m3,m4)
modelsummary(models,estimate = "{estimate}{stars}", output="huxtable")
library(vtable)
vtable(growth)
#| warning: false
#| message: false
library(tidyverse)
library(haven)
library(kableExtra)
growth <- read_dta("Growth.dta")
library(modelsummary)
library(rstatix)
library(vtable)
vtable(growth)
#| warning: false
#| message: false
library(tidyverse)
library(haven)
library(kableExtra)
growth <- read_dta("Growth.dta")
library(modelsummary)
library(rstatix)
library(vtable)
vtable(growth)
glimpse(growth)
ggplot(growth)+aes(x=tradeshare,y=growth)+geom_point()
ggplot(growth)+aes(x=tradeshare,y=growth,color="red",label=country_name)+geom_point()+
geom_text(aes(label=ifelse(tradeshare>1.5,as.character(country_name),'')),hjust=0,vjust=0)+theme_minimal()
ggplot(growth)+aes(x=tradeshare,y=growth,color="red",label=country_name)+geom_point()+
geom_text(aes(label=ifelse(tradeshare>1.5,as.character(country_name),'')),hjust=0,vjust=0)+theme_minimal()+geom_smooth(method = "lm",se=FALSE)
knitr::opts_chunk$set(echo = TRUE)
library(haven)
# load tidyverse
library("tidyverse")
library(haven)
# read in data
lead <- read_dta("lead_mortality.dta")
# load tidyverse
library("tidyverse")
library(haven)
# read in data
lead <- read_dta("lead_mortality.dta")
# mean of infrate for cities with lead
mean_lead <- lead %>%
filter(lead == 1) %>%
summarize(mean(infrate)) %>%
pull() # to save as number
# look at it
mean_lead
# mean of infrate for cities with no lead
mean_no_lead <- lead %>%
filter(lead == 0) %>%
summarize(mean(infrate)) %>%
pull() # to save as number
# look at it
mean_no_lead
# take difference
mean_lead - mean_no_lead
# run t-test of difference
t.test(infrate ~ lead, data = lead)
lead_reg1 <- lm(infrate ~ lead, data = lead)
summary(lead_reg1)
lead_reg2 <- lm(infrate ~ lead + ph, data = lead)
summary(lead_reg2)
lead_reg3 <- lm(infrate ~ lead + ph + lead:ph, data = lead)
summary(lead_reg3)
lead_scatter <- ggplot(data = lead)+
aes(x = ph,
y = infrate)+
geom_point(aes(color = as.factor(lead)))+ # making it a factor makes color discrete rather than continuous!
geom_smooth(method = "lm")+
# now I'm just making it pretty
# changing color
scale_color_viridis_d("Pipes",
labels = c("0" = "Not Lead",
"1" = "Lead"))+ # changing labels for colors
labs(x = "pH",
y = "Infant Mortality Rate")+
theme_classic(base_family = "Fira Sans Condensed",
base_size=20)
lead_scatter
lead_scatter + facet_wrap(~lead,
labeller = labeller(lead = c("0" = "Not Lead",
"1" = "Lead")))+ # change facet titles
guides(color = F) # hide other legend
# regression for no lead
lead %>%
filter(lead == 0) %>%
lm(data = ., infrate ~ lead + ph + lead:ph) %>%
summary()
# regression for lead
lead %>%
filter(lead == 1) %>%
lm(data = ., infrate ~ lead + ph + lead:ph) %>%
summary()
library(huxtable)
huxreg(lead_reg1,
lead_reg2,
lead_reg3,
coefs = c("Constant" = "(Intercept)",
"Lead Pipes" = "lead",
"pH" = "ph",
"Lead * pH" = "lead:ph"),
statistics = c("N" = "nobs",
"R-Squared" = "r.squared",
"SER" = "sigma"),
number_format = 2)
# load data
freedom <- read_csv("https://metricsf21.classes.ryansafner.com/data/freedom.csv")
#| eval: false
# load data
freedom <- read_csv("freedom.csv")
# load data
freedom <- read_csv("freedom.csv")
freedom_plot <- ggplot(data = freedom)+
aes(x = econ_freedom,
y = gdp_pc)+
geom_point(aes(color = continent))+
scale_y_continuous(labels = scales::dollar)+
labs(x = "Economic Freedom Score (0-10)",
y = "GDP per Capita")+
theme_classic(base_family = "Fira Sans Condensed",
base_size = 20)
freedom_plot
freedom_reg1 <- lm(gdp_pc ~ econ_freedom, data = freedom)
summary(freedom_reg1)
freedom_plot +
geom_smooth(method = "lm", formula = "y~x+I(x^2)", color = "green")
# if you want to calculate it in R
library(broom)
freedom_reg2_tidy <- tidy(freedom_reg2)
```{r}
library(broom)
freedom_reg2_tidy <- tidy(freedom_reg2)
freedom_beta_1 <- freedom_reg2_tidy %>%
filter(term == "econ_freedom") %>%
pull(estimate)
freedom_beta_2 <- freedom_reg2_tidy %>%
filter(term == "I(econ_freedom^2)") %>%
pull(estimate)
ggplot(mroz[order(mroz$pred),], aes(x = 1:nrow(mroz),y = pred,color = classes)) +
geom_point() +
theme_bw() +
scale_y_continuous(limits = c(0,1), name = "p(inlf)") +
ggtitle("LPM in a Saturated Model is Perfectly Fine")
